import { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from "@google/generative-ai";

// const {
//   GoogleGenerativeAI,
//   HarmCategory,
//   HarmBlockThreshold,
// } = require("@google/generative-ai");

const apiKey = import.meta.env.VITE_GOOGLE_GEMINI_AI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-1.5-flash",
});

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 64,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};


  export const chatSession = model.startChat({
    generationConfig,
 
    history: [
      {
        role: "user",
        parts: [
          {text: "Generate a 3-day travel itinerary for a couple visiting Mumbai on a budget, with all details in JSON format. Ensure the JSON is structured for easy parsing and usability in a web application. Focus on budget-friendly options, local experiences, and popular attractions. Provide placeholder URLs for images if actual URLs cannot be fetched. Geo coordinates and prices should be realistic.\n\n*Structure Requirements:*\n\n1. *Hotel Options* (3 options):\n    - hotel_name: Name of the hotel\n    - address: Full address of the hotel\n    - price_per_night: Price per night in Indian Rupees (INR)\n    - image_url: Provide placeholder URL if image URL can't be fetched\n    - geo_coordinates: Latitude and longitude in decimal format\n    - rating: Rating out of 5\n    - description: Brief description (maximum 50 words)\n\n2. *Daily Itinerary* (3 days):\n    - For each day, list 4-5 activities or places to visit.\n    - Provide the following details for each activity:\n        - place_name: Name of the place\n        - description: Brief description (maximum 30 words)\n        - image_url: Provide placeholder URL if image URL can't be fetched\n        - geo_coordinates: Latitude and longitude in decimal format\n        - entrance_fee: Entrance fee in INR (if applicable, otherwise \"Free\")\n        - rating: Rating out of 5\n        - time_to_spend: Estimated time to spend at the location (in hours)\n        - best_time_to_visit: Best time of the day to visit (e.g., morning, afternoon)\n    - *Route Suggestion*: Provide suggested travel routes between locations with the total estimated travel time for the day.\n\n3. *Budget Breakdown*:\n    - meals_per_day: Estimated daily expenses for meals (in INR)\n    - transportation_costs: Estimated transportation costs per day (in INR)\n    - miscellaneous_expenses: Additional expenses (in INR)\n\n*Formatting and Guidelines:*\n- Use realistic prices for budget travelers in Mumbai.\n- Provide precise and accurate geo coordinates.\n- All prices should be in INR.\n- Ensure ratings and descriptions are brief but informative.\n- Ensure the JSON structure is valid and well-formatted for parsing.\n- Focus on economical, yet comfortable options for hotels, and budget-friendly attractions.\n\n*Expected Output:*\nThe output should be a detailed JSON object, structured for ease of use in a web app. Provide images that accurately represent the specified location in terms of landmarks, architecture, natural scenery, and other recognizable features. Placeholder values (like image URLs) should be clearly marked if the related image is not found and easily replaceable. Include geo coordinates for all locations and hotels. \n"},
        ],
      },
      {
        role: "model",
        parts: [
          {text: "```json\n{\n  \"hotel_options\": [\n    {\n      \"hotel_name\": \"The Fern, Mumbai\",\n      \"address\": \"142, LBS Marg, Mulund (West), Mumbai - 400080\",\n      \"price_per_night\": 3000,\n      \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=The+Fern%2C+Mumbai\",\n      \"geo_coordinates\": {\n        \"latitude\": 19.1363,\n        \"longitude\": 72.9469\n      },\n      \"rating\": 4.2,\n      \"description\": \"A modern and comfortable hotel with clean rooms and a good location near shopping and dining options.\"\n    },\n    {\n      \"hotel_name\": \"Hotel Royal Orchid\",\n      \"address\": \"Bandra Kurla Complex, Bandra East, Mumbai - 400051\",\n      \"price_per_night\": 2500,\n      \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Hotel+Royal+Orchid\",\n      \"geo_coordinates\": {\n        \"latitude\": 19.0553,\n        \"longitude\": 72.8632\n      },\n      \"rating\": 4.0,\n      \"description\": \"A mid-range hotel offering a comfortable stay with basic amenities and easy access to public transport.\"\n    },\n    {\n      \"hotel_name\": \"Hotel Sun-N-Sand\",\n      \"address\": \"Juhu Beach, Juhu, Mumbai - 400049\",\n      \"price_per_night\": 2000,\n      \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Hotel+Sun-N-Sand\",\n      \"geo_coordinates\": {\n        \"latitude\": 19.0745,\n        \"longitude\": 72.8378\n      },\n      \"rating\": 3.8,\n      \"description\": \"A budget-friendly hotel with a prime location on Juhu Beach, known for its beachside restaurants and vibrant atmosphere.\"\n    }\n  ],\n  \"daily_itinerary\": [\n    {\n      \"day\": \"Day 1: Gateway of India and South Mumbai Exploration\",\n      \"activities\": [\n        {\n          \"place_name\": \"Gateway of India\",\n          \"description\": \"A majestic archway built to commemorate the arrival of King George V and Queen Mary.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Gateway+of+India\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9220,\n            \"longitude\": 72.8347\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.8,\n          \"time_to_spend\": \"2 hours\",\n          \"best_time_to_visit\": \"Evening\"\n        },\n        {\n          \"place_name\": \"Marine Drive\",\n          \"description\": \"A scenic promenade with stunning views of the Arabian Sea, often referred to as the 'Queen's Necklace'.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Marine+Drive\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9355,\n            \"longitude\": 72.8272\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.5,\n          \"time_to_spend\": \"1 hour\",\n          \"best_time_to_visit\": \"Evening\"\n        },\n        {\n          \"place_name\": \"Dhobi Ghat\",\n          \"description\": \"An open-air laundry where thousands of clothes are washed daily, a unique and vibrant sight.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Dhobi+Ghat\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9466,\n            \"longitude\": 72.8316\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.0,\n          \"time_to_spend\": \"1 hour\",\n          \"best_time_to_visit\": \"Morning\"\n        },\n        {\n          \"place_name\": \"Mani Bhavan\",\n          \"description\": \"Gandhiji's former residence in Mumbai, showcasing his life and teachings.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Mani+Bhavan\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9405,\n            \"longitude\": 72.8333\n          },\n          \"entrance_fee\": \"50 INR\",\n          \"rating\": 4.2,\n          \"time_to_spend\": \"1 hour\",\n          \"best_time_to_visit\": \"Morning\"\n        }\n      ],\n      \"route_suggestion\": \"Start at the Gateway of India, walk along Marine Drive, take a local train to Dhobi Ghat, and then visit Mani Bhavan. Total estimated travel time: 3 hours.\"\n    },\n    {\n      \"day\": \"Day 2: Bollywood and Street Food Adventure\",\n      \"activities\": [\n        {\n          \"place_name\": \"Chhatrapati Shivaji Maharaj Terminus\",\n          \"description\": \"A UNESCO World Heritage Site, a stunning example of Victorian Gothic Revival architecture.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Chhatrapati+Shivaji+Maharaj+Terminus\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9539,\n            \"longitude\": 72.8360\n          },\n          \"entrance_fee\": \"50 INR\",\n          \"rating\": 4.7,\n          \"time_to_spend\": \"1 hour\",\n          \"best_time_to_visit\": \"Morning\"\n        },\n        {\n          \"place_name\": \"Film City\",\n          \"description\": \"A bustling film studio complex, offering a glimpse into the world of Bollywood.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Film+City\",\n          \"geo_coordinates\": {\n            \"latitude\": 19.0858,\n            \"longitude\": 72.9204\n          },\n          \"entrance_fee\": \"100 INR\",\n          \"rating\": 4.0,\n          \"time_to_spend\": \"2 hours\",\n          \"best_time_to_visit\": \"Afternoon\"\n        },\n        {\n          \"place_name\": \"Juhu Beach\",\n          \"description\": \"A popular beach with a vibrant atmosphere, known for its street food and sunset views.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Juhu+Beach\",\n          \"geo_coordinates\": {\n            \"latitude\": 19.0745,\n            \"longitude\": 72.8378\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.5,\n          \"time_to_spend\": \"2 hours\",\n          \"best_time_to_visit\": \"Evening\"\n        },\n        {\n          \"place_name\": \"Khau Galli (Street Food Market)\",\n          \"description\": \"A street food paradise in Mumbai, offering a wide range of delicious and affordable snacks.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Khau+Galli\",\n          \"geo_coordinates\": {\n            \"latitude\": 19.0720,\n            \"longitude\": 72.8349\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.2,\n          \"time_to_spend\": \"1 hour\",\n          \"best_time_to_visit\": \"Evening\"\n        }\n      ],\n      \"route_suggestion\": \"Start at Chhatrapati Shivaji Maharaj Terminus, take a local train to Film City, then visit Juhu Beach and end the day at Khau Galli. Total estimated travel time: 4 hours.\"\n    },\n    {\n      \"day\": \"Day 3: Elephanta Caves and Local Markets\",\n      \"activities\": [\n        {\n          \"place_name\": \"Elephanta Caves\",\n          \"description\": \"A UNESCO World Heritage Site, ancient rock-cut cave temples with impressive Hindu sculptures.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Elephanta+Caves\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9892,\n            \"longitude\": 72.9311\n          },\n          \"entrance_fee\": \"250 INR\",\n          \"rating\": 4.8,\n          \"time_to_spend\": \"3 hours\",\n          \"best_time_to_visit\": \"Morning\"\n        },\n        {\n          \"place_name\": \"Crawford Market\",\n          \"description\": \"A vibrant market with a wide range of spices, fruits, vegetables, and local crafts.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Crawford+Market\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9515,\n            \"longitude\": 72.8382\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.0,\n          \"time_to_spend\": \"1 hour\",\n          \"best_time_to_visit\": \"Morning\"\n        },\n        {\n          \"place_name\": \"Colaba Causeway\",\n          \"description\": \"A popular shopping destination with a mix of local boutiques, street vendors, and cafes.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Colaba+Causeway\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9233,\n            \"longitude\": 72.8367\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.2,\n          \"time_to_spend\": \"2 hours\",\n          \"best_time_to_visit\": \"Afternoon\"\n        },\n        {\n          \"place_name\": \"Leopold Cafe\",\n          \"description\": \"A historic cafe in Colaba, famous for its delicious food and charming ambiance.\",\n          \"image_url\": \"https://placehold.co/600x400/FFFFFF/000000?text=Leopold+Cafe\",\n          \"geo_coordinates\": {\n            \"latitude\": 18.9256,\n            \"longitude\": 72.8355\n          },\n          \"entrance_fee\": \"Free\",\n          \"rating\": 4.5,\n          \"time_to_spend\": \"1 hour\",\n          \"best_time_to_visit\": \"Anytime\"\n        }\n      ],\n      \"route_suggestion\": \"Take a ferry to Elephanta Caves, then visit Crawford Market and Colaba Causeway, ending the day at Leopold Cafe. Total estimated travel time: 4 hours.\"\n    }\n  ],\n  \"budget_breakdown\": {\n    \"meals_per_day\": 500,\n    \"transportation_costs\": 200,\n    \"miscellaneous_expenses\": 100\n  }\n}\n```"},
        ],
      },
    ],
  });

          

  